{"version":3,"sources":["../src/renderer.js"],"names":["ipcRenderer","require","GUIUpdater","ApplicationState","E","_path","$funcs","functionality","window","on","PROJECT_DEP","e","dep","console","log","updateProjectDependencies","NEW_FILE","canceled","filePaths","newNodeCreationPrompt","NEW_FOLDER","OPEN_FILES_PRESENT","openFiles","updateOpenFiles","PROCESS_STOPPED","updateGUIState","key","value","DIR_PRESENT","currentDirectory","project","getDBValues","Object","keys","length","send","currentFileDetermination","path","resolve","name","openDirectory","type","getOpenFilesData","PROJECT_TYPE","SAVE_FILE","fileObject","fetchFile","sourceCode","update_code","fileType","saveFiletoSys","filepath","lang","init","update_file","isProcessRenderering","updateCode","saveFile","projecttype","invoke","OPEN_DIR_PROMPT","then","data","openFile","prevOpenFilePath","newlyCreated","code","OPEN_FILE","showFile","object","runProjectRendering","monitorUpdate","RUN_GUI","stopRenderering","stopMonitoring","STOP_GUI","editFile","language","isRunning","updateTime","createNode","nodename","nodepath","session","newNode","module","exports"],"mappings":"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","sourcesContent":["const { ipcRenderer } = require(\"electron\")\r\nconst GUIUpdater = require(\"./ChildProcessUpdater\");\r\nconst ApplicationState = require(\"./db\");\r\nconst E = require(\"./events\");\r\nconst _path = require('path');\r\n\r\n/** in the case of an application startup we set application ui \r\n * according to one of 3 possible cases:\r\n *  -\"FIRST TIME\":\r\n *    ---if it's the first time we on hello world page and prompt user to open a file.\r\n *  -\"NO OPEN WORKING DIRECTORY\":\r\n *    --- in the case where there is no open working directory\r\n *    --- we prompt the user to open a work directory.\r\n *  -\"OPEN WORKING DIRECTORY\":  \r\n *    --- in the case there is a working directory we open code that was previously being opened.\r\n * */\r\n/** contains application state along with functionality  */\r\nlet $funcs = ApplicationState.functionality;\r\nwindow.ApplicationState = ApplicationState;\r\n/** project dependencies are recieved from the main process. */\r\nipcRenderer.on(E.PROJECT_DEP,(e,dep) => { \r\n    console.log(\" dependencies init \",dep);\r\n    ApplicationState.updateProjectDependencies(dep) \r\n})\r\n\r\n/** in the event that a new file is being created. */\r\nipcRenderer.on(E.NEW_FILE,(e,{canceled,filePaths}) => {\r\n    if (canceled) { return; }\r\n    ApplicationState.newNodeCreationPrompt(filePaths[0],'file');\r\n})\r\n\r\n/** in the event that a new folder is being created. */\r\nipcRenderer.on(E.NEW_FOLDER,(e,{ canceled,filePaths }) => {\r\n    if (canceled) { return;}\r\n    ApplicationState.newNodeCreationPrompt(filePaths[0],'directory');\r\n})\r\n\r\nipcRenderer.on(E.OPEN_FILES_PRESENT,(e,openFiles) => {\r\n    //update all the open files.\r\n    ApplicationState.updateOpenFiles(openFiles);\r\n})\r\n\r\nipcRenderer.on(E.PROCESS_STOPPED, e => {\r\n    ApplicationState.updateGUIState([ { key:\"isRunning\",value:false } ])   //set the gui state flag to not running\r\n})\r\n\r\n/** in the event where knowledge of whether directory is already open is needed.*/\r\nipcRenderer.on(E.DIR_PRESENT,async (e) => {\r\n    let currentDirectory,project,openFiles;\r\n    try {\r\n        //current directory.\r\n        currentDirectory = (await ApplicationState.getDBValues('currentDirectory')) || {};\r\n        project          = (await ApplicationState.getDBValues('project')) || {};\r\n        openFiles        = (await ApplicationState.getDBValues('openFiles')) || {};\r\n    }\r\n    catch(e) {}\r\n    if ( Object.keys(openFiles).length > 0 ) {\r\n        ipcRenderer.send(E.OPEN_FILES_PRESENT,openFiles);\r\n    }\r\n    //also determine whether a currentFile already exists.\r\n    ApplicationState.currentFileDetermination();\r\n\r\n    if (currentDirectory.path) {\r\n        currentDirectory = _path.resolve(currentDirectory.path,currentDirectory.name);\r\n        ApplicationState.openDirectory(currentDirectory,project.type,true);\r\n        ApplicationState.getOpenFilesData();;\r\n        ipcRenderer.send(E.DIR_PRESENT,{currentDirectory,PROJECT_TYPE:project.type });\r\n    }\r\n})\r\n\r\n/**save current file being worked on. */\r\nipcRenderer.on(E.SAVE_FILE,async () => {\r\n    let fileObject;\r\n    try {\r\n        fileObject = await ApplicationState.fetchFile();\r\n    }\r\n    catch(e) {\r\n        console.log(\" unable to fetch file from front-end db. \",e);\r\n        return;\r\n    }\r\n    let { path,sourceCode,update_code,fileType } = fileObject;\r\n    //save file to sys call.\r\n    return saveFiletoSys({ filepath:path,sourceCode,update_code,lang:fileType });\r\n})\r\n\r\n//gui updater.\r\nGUIUpdater.init(saveFiletoSys,ApplicationState);\r\n\r\nfunction saveFiletoSys({filepath,sourceCode,update_code,lang }) {\r\n    //send sourcecode and filepath to main process to be saved to the filesystem.\r\n    \r\n    ipcRenderer.send(E.SAVE_FILE,{ filepath,sourceCode,lang,update_file:update_code && !GUIUpdater.isProcessRenderering() });\r\n    //update application state.\r\n    if (update_code && GUIUpdater.isProcessRenderering() ) /** update gui's code. */\r\n        GUIUpdater.updateCode();\r\n    //save file.\r\n    $funcs.saveFile();\r\n}\r\n\r\nconst functionality = {\r\n    openDirectory(projecttype) \r\n    {\r\n        //initialize gui process updater.\r\n        return ipcRenderer.invoke(E.OPEN_DIR_PROMPT,projecttype).then(data => {\r\n            let { canceled,filePaths }  = data;\r\n            //if user canceled open directory prompt return.\r\n            if (canceled == true) return;\r\n            //call ApplicationState.\r\n            console.log(\" opening directory \",filePaths[0]);\r\n            ApplicationState.openDirectory(filePaths[0],projecttype,false);\r\n        });\r\n    },\r\n    ...$funcs,\r\n    async openFile(filepath,prevOpenFilePath,newlyCreated=false) {\r\n        console.log(' filepath ',filepath);\r\n        let code = await ipcRenderer.invoke(E.OPEN_FILE,{ filepath,newlyCreated });\r\n        //once source code is found.\r\n        return $funcs.openFile({ filepath,sourceCode:code,prevOpenFilePath,newlyCreated });\r\n    },\r\n    //showFile changes current file to from current file to file given to function.\r\n    //showFile takes in object {filepath:string,sourceCode:string,prevOpenFilePath:string}\r\n    async showFile(object) { return $funcs.openFile(object); }, \r\n    saveFiletoSys,\r\n    //functionality for when a person wishes to render the code's gui.\r\n    runProjectRendering({filepath,projecttype,sourceCode }) \r\n    {\r\n        //tell gui process updater that gui has been renderered.\r\n        //gui process handler will begin monitering gui process.\r\n        GUIUpdater.monitorUpdate();\r\n        ApplicationState.updateGUIState([ { key:\"isRunning\",value:true}, ]);\r\n        switch(projecttype) {\r\n            case 'html':\r\n                ApplicationState.updateProjectDependencies([ filepath ]);\r\n                break;\r\n        }\r\n        return ipcRenderer.send(E.RUN_GUI,{ filepath,project:projecttype,sourceCode });\r\n    },\r\n    stopRenderering() \r\n    {\r\n        //kill gui monitoring process.\r\n        GUIUpdater.stopMonitoring();\r\n        //stop the current rendering process which is running.\r\n        ApplicationState.updateGUIState(\r\n            [ { key:\"isRunning\",value:false } ]\r\n        );\r\n        //send message to main process to stop child process from running.\r\n        return ipcRenderer.send(E.STOP_GUI);\r\n    },\r\n    //functionality to edit gui.\r\n    editFile({ sourceCode,language,isRunning }) \r\n    {\r\n        console.log(\" file being edited \");\r\n        if (isRunning) /* if gui process is running we update it. */\r\n            {GUIUpdater.updateTime(); console.log(\" running code \"); }\r\n        return $funcs.editFile({ sourceCode,isRunning,language });\r\n    },\r\n    //functionality for creating a new file.\r\n    createNode(nodename,type) \r\n    {\r\n        let { nodepath } = ApplicationState.session.newNode;\r\n        //send absolute path of file to main process.\r\n        console.log(\" filepath \",nodepath);\r\n        switch(type) {\r\n        case 'file': \r\n            ipcRenderer.send(E.NEW_FILE,_path.resolve(nodepath,nodename));\r\n            break;\r\n        case 'directory': \r\n            ipcRenderer.send(E.NEW_FOLDER,_path.resolve(nodepath,nodename));\r\n            break;\r\n        }\r\n        return $funcs.createNode(nodename);\r\n    }\r\n}\r\nmodule.exports = {\r\n    /** @param{$self} React.Component instance ties application state and functionality to Application ui. */\r\n    ...ApplicationState,\r\n    /** functionality prompts user to select a working directory. */\r\n    functionality\r\n    \r\n}"],"file":"renderer.js"}